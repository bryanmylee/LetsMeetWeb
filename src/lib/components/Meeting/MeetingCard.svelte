<script lang="ts" context="module">
  const [send, receive] = crossfade({ duration: 150, easing: cubicOut });
</script>

<script lang="ts">
  import { cubicOut } from 'svelte/easing';
  import { crossfade } from 'svelte/transition';
  import type { ShallowMeeting } from '$lib/gql/types';
  import { onSubmitKey } from '$lib/utils/on-submit-key';
  import { ShareIcon } from 'svelte-feather-icons';
  import ShareModal from './ShareModal.svelte';

  export let meeting: Pick<ShallowMeeting, 'name' | 'slug'>;

  let showShareModal = false;
</script>

<div
  in:receive={{ key: meeting.slug }}
  out:send={{ key: meeting.slug }}
  on:click
  class="flex items-center justify-between p-4 text-white card bg-gradient-primary bg-animate-slow z-50"
>
  <div>
    <h2 class="text-lg font-medium">
      {meeting.name}&nbsp;
    </h2>
  </div>
  <button
    type="button"
    aria-label="Share"
    on:keydown|stopPropagation={onSubmitKey(() => (showShareModal = true))}
    on:click|preventDefault|stopPropagation={() => (showShareModal = true)}
    class="w-10 h-10 -m-2 rounded-full button hover:bg-primary-darker focus:ring-white"
  >
    <ShareIcon class="p-2.5" />
  </button>
</div>

{#if showShareModal}
  <ShareModal slug={meeting.slug} on:dismiss={() => (showShareModal = false)} />
{/if}
